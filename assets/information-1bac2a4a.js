import{_ as oe}from"./on-a50948f4.js";import{aG as ue,aE as I,aD as g,aF as j}from"./webClient-e9003e98.js";import{A as se}from"./accountClient-16268368.js";import{P as ne}from"./publicClient-ee633572.js";import{U as ie}from"./userClient-a269e032.js";import{ae as de,f as re,r as s,o as ve,G as v,h as n,j as d,k as l,n as C,A as _,C as u,v as c,F as N,V as P,t as Y,z as q,ag as ce,ah as me,g as pe}from"./plugin-vue_export-helper-3a3407bb.js";import"./_commonjsHelpers-725317a4.js";import"./vue-router.esm-bundler-0ff22247.js";const _e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAAhCAYAAABeD2IVAAAABHNCSVQICAgIfAhkiAAAAttJREFUWEe9l79O3EAQxrGUKhICHiDirk6RUKZAuRMdTYgUIaIUQJMCCkjqSBxvAE/ApU5BqrQ5noBLmybOEwT6KMf3s2bR4njPZr3HSqO198/M529nZsfZXKBNJpPnmjqXdAJLco3vZlk2CumIHc+qNgoQQC4lizWKrzTfFTD6ZC0ECkAwdS05CVg7tPHOzEGJpYGMHZnBDzIYAjWntYupAWG3YArl6rYlPcmGx0xyfwmwjp3P+sC8AGWAOK5OMqeIU4Rf9gVsDKihsYSqizh9rXfhvwuSXKC6gPqjF47vVAPOeVtbKSuwE3nmjf9w/qg5XIb0QytATezlWIsGydGYQpn5qsdXnv6CFd4111P33eb6DwmKKD7wQF0IFGBmA8qS7bL0/3YRdB/GkzGFIq4YA/TLPxY9D81HG2X6JKCkZCSjLyXHBmCsnujxW66X14R4HWvJQREcFlmENVG8I3EODVNc2jh5sLUCZTmNFAJD3HmVLJgRgMAewFam+Vo0KG2EgTM+VwYqL3KfCit9uCloXCHsr2xtQOEjRNhtKNccyWPNf5Gsw5ZALSUFVYowfGQ4DRBz2vNC3TvJvq3lXhtV7Yti6r9NDapN7fkkAE8k7w1IsAxKAapblyBlZE1ANg2MAxW8xmJBdWTAJUhyTzDEZQB2YIn2V7I3k+MzH8nV4+jBSDJAH7UGJ6fNS97a85KrCsp+FcWUgRqod2UyeedOjiodGVv+SbYkJNSpEdsGFMphyyXEvp5/SqiR8CGOzTUArUqe2kAw8uyDe+rjShd9kV+Mkam/SegfmXHA8PzGGGJ46s9Ha1CmAGBDY8wjp/KxaU6LZ8qZtWQ60DsAy9UBy6j1D5tUCEmY8vnwqgNXIeD847o8VuY02tHrzqnNfBUovo4Iop/Z30wN6B3NI0UFwo+DH1FtPjjF3uI3z/22wxCOW+W0KYw10XEKBrL+nWLNzraJgqRryiXNDbmmwU+L0i9gAAAAAElFTkSuQmCC";const r=B=>(ce("data-v-bb07b604"),B=B(),me(),B),fe={class:"nav-con"},Ae={key:0,class:"info-con"},ge=["src"],Ce=r(()=>l("div",{class:"mask"},[l("img",{src:_e,alt:""})],-1)),Be={class:"form-item"},Fe=r(()=>l("div",{class:"form-item-tag"},"昵称",-1)),we={class:"input"},he={class:"form-item"},ye=r(()=>l("div",{class:"form-item-tag"},"手机号",-1)),Ee={class:"input"},Ve={class:"form-item"},ke=r(()=>l("div",{class:"form-item-tag"},"邮箱",-1)),De={class:"input"},be={class:"form-item"},Ue=r(()=>l("div",{class:"form-item-tag"},"QQ",-1)),Ie={class:"input"},Ne={class:"form-item"},Pe=r(()=>l("div",{class:"form-item-tag"},"性别",-1)),Ye={class:"input",style:{height:"30px"}},qe={class:"form-item"},xe=r(()=>l("div",{class:"form-item-tag"},"生日",-1)),Ge={class:"input"},Se={class:"form-item"},ze=r(()=>l("div",{class:"form-item-tag"},"居住地",-1)),He={class:"input-tag"},Ke={key:1,class:"updataPass"},je={class:"form-item"},Te=r(()=>l("div",{class:"form-item-tag"},"原登录密码",-1)),Qe={class:"input"},Le={class:"form-item"},Me=r(()=>l("div",{class:"form-item-tag"},"设置新密码",-1)),Ze={class:"input"},Je={class:"form-item"},Oe=r(()=>l("div",{class:"form-item-tag"},"确认新密码",-1)),We={class:"input"},Xe=["loading"],Re={class:"headDialog"},$e={class:"head-nav"},ea={key:0,class:"default-con mt20"},aa=["onClick"],ta=["src"],la={key:0,src:oe,alt:"",class:"onImg"},oa={key:1,class:"mt40"},ua=["src"],sa={class:"dialog-footer"},na=re({__name:"information",setup(B){let E=new se,V=new ne,F=new ie;const{proxy:T}=pe(),m=s(),f=s(1),w=s(!1),k=s(""),A=s(""),D=s(""),h=s(!1),x=s({}),a=s(null),y=s([]),b=s([]),G=s([]),p=s(1),Q=s("http://60.216.20.210:8000/gateway/outside/uploadOss/uploadFiles");ve(async()=>{if(x.value=await{Authorization:ue()},await L(),a.value=await I(),m.value=await I().headPortrait,a.value.province=await a.value.province?Number(a.value.province):null,a.value.city=await a.value.city?Number(a.value.city):null,await V.getAreaDataChild("1").then(o=>{y.value=o.data}),a.value.province)for(let o of y.value)o.areaId==a.value.province&&V.getAreaDataChild("2",o.areaId).then(e=>{b.value=e.data})});const L=()=>{F.getDefaultHeadPortrait().then(o=>{G.value=o.data})},M=async()=>{if(A.value==""){g({title:"提示",message:"请输入新密码",type:"warning"});return}if(A.value.length<6){g({title:"提示",message:"输入的密码长度小于6",type:"warning"});return}if(A.value!==D.value){g({title:"提示",message:"两次输入的密码不一样密码",type:"warning"});return}(await F.resetPwd(I().userId,k.value,A.value)).code===0&&E.logout()},S=o=>{p.value=o,T.goPage(`/mine/information?lType=${3}&rType=${o}`)},Z=()=>{const o=a.value;o.city=null;for(let e of y.value)e.areaId==a.value.province&&V.getAreaDataChild("2",e.areaId).then(i=>{b.value=i.data})},J=async()=>{let o=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!a.value.nickName){g({title:"提示",message:"用户名不能为空",type:"warning"});return}if(a.value.email&&!o.test(a.value.email)){g({title:"提示",message:"邮箱格式不正确",type:"warning"});return}h.value=await!0;const e=await F.modifyUserInfo(a.value.userId,a.value.nickName,a.value.province,a.value.city?a.value.city:"",a.value.birthday,a.value.address,a.value.qqCode,a.value.sex,a.value.headPortrait,a.value.email);if(h.value=await!1,e.code==0){let i=await E.getUserInfo(a.value.userId);await j(i.data),setTimeout(()=>{window.location.href="/mine/information"},1e3)}},O=async()=>{if((await F.modifyUserHeadPortrait({headPortrait:m.value})).code==0){let e=await E.getUserInfo(a.value.userId);await j(e.data),setTimeout(()=>{window.location.href="/mine/information"},1e3)}},W=(o,e,i)=>{m.value=e.response[0].pathOSSStr},X=o=>{if(o.size/1024/1024>5)return g({title:"错误",message:"图片不得超过5MB",type:"error",duration:2e3}),!1};return(o,e)=>{const i=v("el-input"),z=v("el-radio"),R=v("el-date-picker"),H=v("el-option"),K=v("el-select"),$=v("el-divider"),U=v("el-button"),ee=v("el-svg-icon"),ae=v("el-upload"),te=v("el-dialog");return n(),d("div",null,[l("div",fe,[l("div",{class:C(["nav-con-item",p.value==1?"ontext":""]),onClick:e[0]||(e[0]=t=>S(1))},[_(" 基本信息 "),l("div",{class:C(p.value==1?"onview":"")},null,2)],2),l("div",{class:C(["nav-con-item",p.value==2?"ontext":""]),onClick:e[1]||(e[1]=t=>S(2))},[_(" 修改密码 "),l("div",{class:C(p.value==2?"onview":"")},null,2)],2)]),p.value==1&&a.value?(n(),d("div",Ae,[l("div",{class:"info-head pointer",onClick:e[2]||(e[2]=t=>w.value=!0)},[l("img",{src:a.value.headPortrait,alt:"",class:"head-img"},null,8,ge),Ce]),l("div",Be,[Fe,l("div",we,[u(i,{placeholder:"请输入昵称",modelValue:a.value.nickName,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.nickName=t),clearable:""},null,8,["modelValue"])])]),l("div",he,[ye,l("div",Ee,[u(i,{modelValue:a.value.tel,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.tel=t),disabled:"",clearable:""},null,8,["modelValue"])])]),l("div",Ve,[ke,l("div",De,[u(i,{placeholder:"请输入邮箱",modelValue:a.value.email,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.email=t),clearable:""},null,8,["modelValue"])])]),l("div",be,[Ue,l("div",Ie,[u(i,{placeholder:"请输入QQ号码",modelValue:a.value.qqCode,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.qqCode=t),clearable:""},null,8,["modelValue"])])]),l("div",Ne,[Pe,l("div",Ye,[u(z,{modelValue:a.value.sex,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.sex=t),label:1},{default:c(()=>[_("男")]),_:1},8,["modelValue"]),u(z,{modelValue:a.value.sex,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.sex=t),label:2},{default:c(()=>[_("女")]),_:1},8,["modelValue"])])]),l("div",qe,[xe,l("div",Ge,[u(R,{modelValue:a.value.birthday,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.birthday=t),type:"date",placeholder:"请选择生日",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])]),l("div",Se,[ze,l("div",He,[u(K,{modelValue:a.value.province,"onUpdate:modelValue":e[10]||(e[10]=t=>a.value.province=t),placeholder:"请选择省",onChange:e[11]||(e[11]=t=>Z())},{default:c(()=>[(n(!0),d(N,null,P(y.value,t=>(n(),Y(H,{key:t.areaName,label:t.areaName,value:t.areaId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u($),u(K,{modelValue:a.value.city,"onUpdate:modelValue":e[12]||(e[12]=t=>a.value.city=t),placeholder:"请选择市"},{default:c(()=>[(n(!0),d(N,null,P(b.value,t=>(n(),Y(H,{key:t.areaName,label:t.areaName,value:t.areaId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),u(U,{loading:h.value,onClick:J,class:"sub-btn"},{default:c(()=>[_("保存修改")]),_:1},8,["loading"])])):q("",!0),p.value==2?(n(),d("div",Ke,[l("div",je,[Te,l("div",Qe,[u(i,{type:"password",clearable:"",placeholder:"请输入原密码",modelValue:k.value,"onUpdate:modelValue":e[13]||(e[13]=t=>k.value=t)},null,8,["modelValue"])])]),l("div",Le,[Me,l("div",Ze,[u(i,{type:"password",clearable:"",placeholder:"请输入新密码",modelValue:A.value,"onUpdate:modelValue":e[14]||(e[14]=t=>A.value=t)},null,8,["modelValue"])])]),l("div",Je,[Oe,l("div",We,[u(i,{type:"password",clearable:"",placeholder:"请再次输入新密码",modelValue:D.value,"onUpdate:modelValue":e[15]||(e[15]=t=>D.value=t)},null,8,["modelValue"])])]),l("div",{loading:h.value,onClick:M,class:"sub-btn"},"确认修改",8,Xe)])):q("",!0),u(te,{title:"更换头像",width:880,modelValue:w.value,"onUpdate:modelValue":e[20]||(e[20]=t=>w.value=t),center:"","close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1,onClose:e[21]||(e[21]=t=>f.value=1)},{footer:c(()=>[l("div",sa,[u(U,{onClick:e[18]||(e[18]=t=>w.value=!1)},{default:c(()=>[_("关闭")]),_:1}),u(U,{type:"primary",onClick:e[19]||(e[19]=t=>O())},{default:c(()=>[_("确定 ")]),_:1})])]),default:c(()=>[l("div",Re,[l("div",$e,[l("span",{class:C({on:f.value==1}),onClick:e[16]||(e[16]=t=>f.value=1)},"默认头像",2),l("span",{class:C({on:f.value==2}),onClick:e[17]||(e[17]=t=>f.value=2)},"自定义头像",2)]),f.value==1?(n(),d("div",ea,[(n(!0),d(N,null,P(G.value,(t,le)=>(n(),d("div",{class:"default-item",key:le,onClick:ia=>m.value=t.url},[l("img",{src:t.url,alt:"",class:"img"},null,8,ta),t.url==m.value?(n(),d("img",la)):q("",!0)],8,aa))),128))])):(n(),d("div",oa,[u(ae,{class:"avatar-uploader",ref:"upload",name:"file","show-file-list":!1,headers:x.value,action:Q.value,accept:".jpg,.png","before-upload":X,"on-success":W},{default:c(()=>[m.value?(n(),d("img",{key:0,src:m.value,class:"avatar"},null,8,ua)):(n(),Y(ee,{key:1,name:"Plus",size:28,color:"#8c939d"}))]),_:1},8,["headers","action"])]))])]),_:1},8,["modelValue"])])}}}),Aa=de(na,[["__scopeId","data-v-bb07b604"]]);export{Aa as default};
