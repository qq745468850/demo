import{C as g}from"./coachClient-9554e82c.js";import{A as p}from"./accountClient-16268368.js";import{aa as y}from"./webClient-e9003e98.js";import{_ as f}from"./teacher-img-725b40ec.js";import{ae as w,h as r,j as d,k as s,B as _,A as u,z as D,n as c,F as C,V as k,x as L,ag as P,ah as b}from"./plugin-vue_export-helper-3a3407bb.js";import"./_commonjsHelpers-725317a4.js";import"./vue-router.esm-bundler-0ff22247.js";let I=new p,v=new g;const S={data(){return{classId:"",onData:{},showPrompt:!0,userInfo:{},id:"",switchStyle:!0,isFullscreen:!1,msg:"",msgDW:"",msgList:[],nickName:"",isPlay:!1}},async created(){this.id=this.$route.query.id,this.classId=this.$route.query.classId;let e=await I.checkLogIn();e&&(this.userInfo=e,this.nickName=this.userInfo.nickName,this.queryClassMeetingDetails())},watch:{isFullscreen(){this.isFullscreen==!0&&(this.switchStyle=!0)}},beforeDestroy(){DWLive.destroy()},methods:{async queryClassMeetingDetails(){let e=await v.queryClassMeetingDetails(1,99,this.id);this.onData=await e.data,await this.initCCPlayer(),this.onData.liveCourseStatus==1?(this.isPlay=await!0,await this.initCCPlayer()):this.isPlay=await!1},addClassMeetingRecords(){v.addClassMeetingRecords(this.classId,this.id,this.userInfo.userId)},initCCPlayer(){let e=this.onData.liveLink,h=e.split("&")[0].split("=")[1],t=e.split("&")[1].split("=")[1];var n=this;DWLive.init({userid:t,roomid:h,viewertoken:"123",pcH5Live:!0,viewername:n.nickName}),DWLive.onLiveStart=function(i){console.log(i)},DWLive.onLiveEnd=function(i){console.log(i)},DWLive.onPublicChatMessage=async function(i){let m=JSON.parse(i);n.msgList=await n.msgList.concat(m),await n.$forceUpdate(),$("#msg-list").scrollTop($("#msg-list")[0].scrollHeight)}},submit(){this.msgDW!=""?(DWLive.sendPublicChatMsg(this.msgDW),this.msgDW=""):alert("请输入内容~！")},showEm(e){if(!$.trim(e))return"";e=e.replace(/\</g,"&lt;"),e=e.replace(/\>/g,"&gt;"),e=e.replace(/\n/g,"<br/>"),e=e.replace(/\[em_([0-9]*)\]/g,'<img src="//view.csslcloud.net/img/em/$1.gif" border="0" />'),e=e.replace(/\[em2_([0-9]*)\]/g,'<img src="//view.csslcloud.net/img/em2/$1.png" border="0" />');var l="";return $.each(e.split(" "),function(h,o){if(o=$.trim(o),o.indexOf("[uri_")==0&&o.indexOf("]")==o.length-1&&o.length>6){var t=o.substring(5,o.length-1)+" ";l+='<a target="_blank" style="color: #2f53ff" href="'+t+'">'+t+"</a> "}else l+=o+" "}),l}}},a=e=>(P("data-v-c22dcd4e"),e=e(),b(),e),M={class:"pannel"},x={class:"video-pannel"},N={class:"video-con"},W={class:"video-left"},F={class:"video-title"},q=["title"],E={key:0,class:"player-Prompt"},T=a(()=>s("div",{class:"icon"},[s("i",{class:"iconfont iconzhuyi"})],-1)),V=a(()=>s("div",{class:"text"}," 课程视频版权所有，禁止任何形式得转载！并未经本公司书面许可的使用行为，我公司均保留追究法律责任的权利。 ",-1)),B=a(()=>s("i",{class:"iconfont iconguanbi"},null,-1)),H={class:"video-block"},O={class:"player-main"},z=a(()=>s("div",{class:"play-mask"},null,-1)),A=a(()=>s("div",{id:"drawPanel"},null,-1)),U=[A],R={class:"teacher"},j={class:"tea-img"},J=["src"],G={class:"video-right"},K={class:"teacher-video"},Q=a(()=>s("div",{id:"livePlayer",style:{width:"100%",height:"100%",position:"relative"}},null,-1)),X=[Q],Y=a(()=>s("img",{src:f},null,-1)),Z=a(()=>s("div",{class:"text"},"讲师赶来中...",-1)),ss=[Y,Z],es={class:"playback"},ts=a(()=>s("div",{class:"text"},"聊天区",-1)),is={class:"msg-list",id:"msg-list"},ls={class:"name"},os={class:"msg"},as=["innerHTML"],ns={class:"msg-btn"},cs={class:"btn-block"};function rs(e,l,h,o,t,n){return r(),d("div",M,[s("div",x,[s("div",N,[s("div",W,[s("div",F,[s("div",{class:"title oneEllipsis",title:t.onData.classMeetingName},_(t.onData.classMeetingName),9,q)]),t.showPrompt?(r(),d("div",E,[T,V,s("div",{class:"player-Prompt-close",onClick:l[0]||(l[0]=i=>t.showPrompt=!1)},[u(" 关闭 "),B])])):D("",!0),s("div",H,[s("div",O,[z,s("div",{class:c([t.switchStyle?"style1":"style2",t.isPlay?"":"null"])},U,2)])]),s("div",R,[s("div",j,[s("img",{src:t.onData.teacherPortrait,alt:""},null,8,J)]),u(" 讲师："+_(t.onData.teacherName),1)])]),s("div",G,[s("div",{class:c(t.isFullscreen?"player-function functionisFullscreen":"player-function")},[s("div",K,[s("div",{class:c([t.switchStyle?"style1":"style2",t.isPlay?"":"null"])},X,2),s("div",{class:c(t.isPlay?"null":"playIsnull")},ss,2)])],2),s("div",es,[ts,s("div",is,[(r(!0),d(C,null,k(t.msgList,(i,m)=>(r(),d("div",{class:c(i.username==t.nickName?"my msg-item":"msg-item"),key:m},[s("div",ls,_(i.username),1),s("div",os,[s("div",{innerHTML:n.showEm(i.msg)},null,8,as)])],2))),128))]),s("div",ns,[s("div",cs,[L(s("input",{name:"name",placeholder:"参与聊天","onUpdate:modelValue":l[1]||(l[1]=i=>t.msgDW=i)},null,512),[[y,t.msgDW]]),s("div",{class:"submit",onClick:l[2]||(l[2]=i=>n.submit())},"发送")])])])])])])])}const ps=w(S,[["render",rs],["__scopeId","data-v-c22dcd4e"]]);export{ps as default};
