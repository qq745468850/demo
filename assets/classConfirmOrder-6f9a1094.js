import{_ as V,a as N}from"./wx-addb0809.js";import{u as S}from"./vue-router.esm-bundler-926c5a09.js";import{O as P}from"./orderClient-3c76ba2d.js";import{_ as M}from"./plugin-vue_export-helper-c27b6911.js";import{aD as m}from"./webClient-2e88593a.js";import{f as T,r as u,o as U,$,G as f,h as c,j as d,k as e,B as r,F as j,V as z,n as C,A as a,z as y,C as E,v as D,af as L,ag as W,g as q}from"./runtime-core.esm-bundler-201072b8.js";import"./commonjsHelpers-725317a4.js";const i=v=>(L("data-v-1be2e72a"),v=v(),W(),v),G={class:"pannel"},H={key:0,class:"content-con"},J=i(()=>e("div",{class:"nav-title"},"订单信息",-1)),X={class:"nav-order"},K={class:"goods-con"},Q=i(()=>e("div",{class:"title"},"产品信息",-1)),Y={class:"info"},Z=["src"],R={class:"info-con"},ee={class:"title"},se={class:"price"},te={class:"pay-con"},oe=i(()=>e("div",{class:"title"},"选择支付方式",-1)),ae={class:"con"},ne=i(()=>e("img",{src:V},null,-1)),ue=i(()=>e("img",{src:N},null,-1)),ie={class:"con-r"},le={key:0,class:"row"},ce={class:"jian"},de={class:"row"},re={class:"price"},_e=i(()=>e("span",null,"￥",-1)),ve={class:"submit"},me={class:"wxcode"},pe=i(()=>e("div",{class:"tip"},"打开手机微信[扫一扫]",-1)),Fe={class:"price"},he={class:"code-img"},ge=["src"],fe={key:0,class:"success-tip"},ye=T({__name:"classConfirmOrder",setup(v){let p=new P;const{proxy:B}=q(),F=u(),A=u(""),h=u(!1),l=u("Alipay"),I=S(),g=u(!1),_=u(),t=u({});U(()=>{_.value=I.query.orderId,w()}),$(()=>{clearInterval(F.value)});const w=()=>{p.getOrderDetilsById(_.value).then(o=>{o.code==0?t.value=o.data:m({title:"提示",message:`未找到${_.value}此订单信息`,type:"warning"})})},x=()=>{g.value=!0,p.orderMyOrder(_.value,l.value).then(o=>{if(o.code==0)if(l.value=="Alipay"){const s=document.createElement("div");s.innerHTML=o.data,document.body.appendChild(s),document.forms[0].submit()}else A.value=JSON.parse(o.data).codeUrlImg,h.value=!0,F.value=setInterval(()=>{p.getOrderDetilsById(_.value).then(s=>{s.code==0?(t.value=s.data,t.value.finishStatusCode=="1"&&(clearInterval(F.value),setTimeout(()=>{window.location.href="/mine/orderManage"},1e3))):m({title:"提示",message:s.msg,type:"warning"})})},2e3);else o.code==600?(m({title:"提示",message:"支付成功",type:"success"}),B.goPage("/mine")):m({title:"提示",message:o.msg,type:"error"});g.value=!1})};return(o,s)=>{const O=f("el-button"),k=f("el-svg-icon"),b=f("el-dialog");return c(),d("div",G,[t.value?(c(),d("div",H,[J,e("div",X,"订单号："+r(t.value.orderNum),1),e("div",K,[Q,(c(!0),d(j,null,z(t.value.itemsVosList,(n,Ee)=>(c(),d("div",Y,[e("img",{src:n.imageUrl,alt:""},null,8,Z),e("div",R,[e("div",ee,r(n.commodityName),1),e("div",se,"￥"+r(n.currentPrice),1)])]))),256))]),e("div",te,[oe,e("div",ae,[e("div",{class:C(["con-l pointer",{"pay-on":l.value=="Alipay"}]),onClick:s[0]||(s[0]=n=>l.value="Alipay")},[ne,a(" 支付宝支付 ")],2),e("div",{class:C(["con-l pointer",{"pay-on":l.value=="WeChat"}]),onClick:s[1]||(s[1]=n=>l.value="WeChat")},[ue,a(" 微信支付 ")],2),e("div",ie,[t.value.discountAmountPrice?(c(),d("div",le,[a("优惠券："),e("span",ce,"-￥"+r(t.value.discountAmountPrice),1)])):y("",!0),e("div",de,[a(" 需付金额： "),e("div",re,[_e,a(r(t.value.currentPrice),1)])])])]),e("div",ve,[E(O,{loading:g.value,class:"btn pointer",onClick:x},{default:D(()=>[a("立即支付")]),_:1},8,["loading"])])])])):y("",!0),E(b,{modelValue:h.value,"onUpdate:modelValue":s[2]||(s[2]=n=>h.value=n)},{default:D(()=>[e("div",me,[pe,e("div",Fe,[a("支付 "),e("span",null,r(t.value.currentPrice),1),a(" 元")]),e("div",he,[e("img",{src:A.value,alt:""},null,8,ge)]),t.value.finishStatusCode==1?(c(),d("div",fe,[E(k,{name:"SuccessFilled",color:"#06C05F",size:40,class:"mr10"}),a(" 支付成功 ")])):y("",!0)])]),_:1},8,["modelValue"])])}}}),Oe=M(ye,[["__scopeId","data-v-1be2e72a"]]);export{Oe as default};
