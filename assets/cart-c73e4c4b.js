import{a as P}from"./vue-router.esm-bundler-0ff22247.js";import{aE as H,aC as R}from"./webClient-e9003e98.js";import{O as j}from"./orderClient-feb49149.js";import{ae as G,f as U,r,o as q,H as z,G as _,X,h as u,j as v,k as c,C as s,v as d,u as y,x as J,t as B,F as K,V as Q,B as p,z as W,A as C,g as Y}from"./plugin-vue_export-helper-3a3407bb.js";import{s as Z}from"./shopping-cart-ba0beff8.js";import{l as I}from"./list-3c00e85f.js";import"./_commonjsHelpers-725317a4.js";const ee={class:"pannel"},te={class:"pannel-con"},ae={key:0,class:"goods-con"},oe=["src","onClick"],le={class:"con"},ne=["onClick"],se={key:1},ie={class:"foot-div"},re={class:"danger"},ce=U({__name:"cart",setup(ue){let h=new j;const N=P(),{proxy:$}=Y(),f=r(!1),g=r(!1),D=r(null),m=r([]),w=r([]),A=r([{name:"课程/商品名称",val:"title"},{name:"价格",val:"price",width:60}]),o=r(0);q(async()=>{D.value=H(),k()});const T=t=>{o.value=0,t!=[]&&t.forEach((a,e)=>{o.value=Number(o.value)+Number(a.originalPrice)}),w.value=t},k=async()=>{f.value=!0,h.getMyCart().then(t=>{o.value=0,t.code==0&&(m.value=t.data,z(async()=>{let a=await $.$refs.multipleTable;m.value.forEach((e,l)=>{a.toggleRowSelection(m.value[l],!0)})})),f.value=!1})},M=async t=>{h.removeMyItem(t.id).then(a=>{o.value=0,a.code==0&&(m.value.forEach((e,l)=>{o.value=Number(o.value)+Number(e.originalPrice)}),k())})},E=(t,a)=>{let e="";switch(a){case 0:e=`/coachcourse/details?id=${t}`;break;case 1:e=`/coachcourse/videoCourse?courseId=${t}`;break;case 2:e=`/coachcourse/liveCourse?courseId=${t}`;break;case 3:e=`/questionBank/packHome?id=${t}`;break;case 4:e=`/database/detail?id=${t}`;break;case 6:e=`/opencourse/details?id=${t}`;break}window.open(e,"_blank")},S=()=>{if(o.value==0){R.warning("请选择商品！");return}g.value=!0;let t=[],a=[],e;for(e of w.value){let l={trolleyId:e.id};a.push(l),t.push(e.tId)}h.addPayOrdersByTrolley(a).then(l=>{l.code==0&&N.push(`/order/confirmOrder?orderId=${l.data.orderNum}`),g.value=!1})};return(t,a)=>{const e=_("el-step"),l=_("el-steps"),b=_("el-table-column"),F=_("el-button"),V=_("el-table"),L=X("loading");return u(),v("div",ee,[c("div",te,[s(l,{active:0,"align-center":""},{default:d(()=>[s(e,{title:"我的购物车",icon:y(Z)},null,8,["icon"]),s(e,{title:"确认订单信息",icon:y(I)},null,8,["icon"]),s(e,{title:"支付订单",icon:y(I)},null,8,["icon"])]),_:1}),J((u(),B(V,{data:m.value,ref:"multipleTable",fit:"","highlight-current-row":"",style:{width:"100%"},onSelectionChange:T},{default:d(()=>[s(b,{type:"selection",width:"55"}),(u(!0),v(K,null,Q(A.value,(i,x)=>(u(),B(b,{key:x,label:i.name,align:"center","min-width":i.width},{default:d(n=>[i.val=="title"?(u(),v("div",ae,[c("img",{src:n.row.imageUrl,class:"img",onClick:O=>E(n.row.commodityId,Number(n.row.commodityTypeCode)),alt:""},null,8,oe),c("div",le,[c("div",{class:"title twoEllipsis",onClick:O=>E(n.row.commodityId,Number(n.row.commodityTypeCode))},p(n.row.commodityName),9,ne)])])):i.val=="price"?(u(),v("span",se,p(n.row.originalPrice),1)):W("",!0),c("span",null,p(n.row[i.val]),1)]),_:2},1032,["label","min-width"]))),128)),s(b,{label:"操作",align:"center",width:"100","class-name":"fixed-width"},{default:d(i=>[s(F,{text:"",type:"primary",onClick:x=>M(i.row)},{default:d(()=>[C("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,f.value]]),c("div",ie,[C(" 应付："),c("span",re,"￥ "+p(o.value.toFixed(2)),1),s(F,{type:"primary",class:"ml16",loading:g.value,disabled:o.value==0,onClick:S},{default:d(()=>[C(" 马上结算")]),_:1},8,["loading","disabled"])])])])}}}),ge=G(ce,[["__scopeId","data-v-e88a8222"]]);export{ge as default};
