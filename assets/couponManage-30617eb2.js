import{aE as U,N as P,aD as b}from"./webClient-2e88593a.js";import{P as z}from"./publicClient-90b64d32.js";import{u as j}from"./vue-router.esm-bundler-926c5a09.js";import{U as q}from"./userClient-1707b307.js";import{_ as G}from"./plugin-vue_export-helper-c27b6911.js";import{f as K,r as n,o as L,G as C,X as R,h as c,j as d,k as e,n as l,A as v,x as X,C as _,F as H,V as J,B as f,t as O,v as Q,z as W,af as Y,ag as Z,g as ee}from"./runtime-core.esm-bundler-201072b8.js";import"./_commonjsHelpers-725317a4.js";const oe=m=>(Y("data-v-eea3d434"),m=m(),Z(),m),te={class:"nav-con"},se={class:""},ae={class:"nav-second"},ne={key:0,class:"content-con"},ue={class:"num-con"},le={class:"price"},ie=oe(()=>e("span",null,"￥",-1)),ce={class:"cat"},de={class:"coupon-info"},ve=["title"],re={class:"time"},pe={key:0,class:"change-coupon"},_e={class:"item"},me={class:"input"},ge={class:"item"},Ce={class:"input"},fe=["src"],Fe=K({__name:"couponManage",setup(m){let h=new q,k=new z;const{proxy:D}=ee(),B=n(),E=n(),r=n(""),p=n(""),i=n(!1),A=j(),u=n(1),a=n(1),F=n([]),N=n({});L(async()=>{await y(),u.value=Number(A.query.rType),N.value=U(),g()});const T=async()=>{r.value==""||p.value==""?b({title:"提示",message:"请填写完整的信息",type:"warning"}):(i.value=!0,k.checkVerification(p.value,E.value).then(s=>{s.code==0?h.postexchangeCode(r.value).then(o=>{o.code==0&&(r.value="",p.value=""),i.value=!1}):(b({title:"提示",message:s.msg,type:"error"}),y(),i.value=!1)}))},y=()=>{k.getVerifyCode().then(s=>{B.value=s.data.img,E.value=s.data.imgId})},V=s=>{u.value=s,D.goPage(`/mine/couponManage?lType=${2}&rType=${s}`)},g=async()=>{i.value=await!0;const s=await h.getcouponsData(a.value);F.value=await s.data,i.value=await!1};return(s,o)=>{const w=C("el-divider"),$=C("el-empty"),x=C("el-input"),I=C("el-button"),M=R("loading");return c(),d("div",null,[e("div",te,[e("div",{class:l(["nav-con-item",u.value==1?"ontext":""]),onClick:o[0]||(o[0]=t=>V(1))},[v(" 优惠券 "),e("div",{class:l(u.value==1?"onview":"")},null,2)],2),e("div",{class:l(["nav-con-item",u.value==2?"ontext":""]),onClick:o[1]||(o[1]=t=>V(2))},[v(" 兑换券 "),e("div",{class:l(u.value==2?"onview":"")},null,2)],2)]),X((c(),d("div",se,[e("div",ae,[e("span",{class:l(a.value==1?"on":""),onClick:o[2]||(o[2]=t=>(a.value=1,g()))},"可使用",2),_(w,{direction:"vertical"}),e("span",{class:l(a.value==2?"on":""),onClick:o[3]||(o[3]=t=>(a.value=2,g()))},"已使用",2),_(w,{direction:"vertical"}),e("span",{class:l(a.value==3?"on":""),onClick:o[4]||(o[4]=t=>(a.value=3,g()))},"已过期",2)]),F.value.length>0?(c(),d("div",ne,[(c(!0),d(H,null,J(F.value,(t,S)=>(c(),d("div",{class:l(["coupon-item",a.value==2?"bg2":a.value==3?"bg3":""]),key:S},[e("div",ue,[e("div",le,[ie,v(f(t.discountAmount),1)]),e("div",ce,f(t.scopeType==1?"无门槛":`满${t.limitPrice}元可用`),1)]),e("div",de,[e("div",{class:"name oneEllipsis",title:t.couponName},f(t.couponName),9,ve),e("div",re,"有效期至："+f(t.endTime),1)])],2))),128))])):(c(),O($,{key:1,description:"暂无数据~"}))])),[[P,u.value==1],[M,i.value]]),u.value==2?(c(),d("div",pe,[e("div",_e,[v(" 兑换码 "),e("div",me,[_(x,{placeholder:"请输入兑换码",modelValue:r.value,"onUpdate:modelValue":o[5]||(o[5]=t=>r.value=t)},null,8,["modelValue"])])]),e("div",ge,[v(" 验证码 "),e("div",Ce,[_(x,{placeholder:"请输入验证码",modelValue:p.value,"onUpdate:modelValue":o[6]||(o[6]=t=>p.value=t)},null,8,["modelValue"])]),e("img",{src:B.value,alt:"",onClick:o[7]||(o[7]=t=>y())},null,8,fe)]),_(I,{loading:i.value,class:"submit-btn",onClick:T},{default:Q(()=>[v("立即兑换")]),_:1},8,["loading"])])):W("",!0)])}}}),xe=G(Fe,[["__scopeId","data-v-eea3d434"]]);export{xe as default};
