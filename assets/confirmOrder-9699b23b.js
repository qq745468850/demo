import{_ as M,a as U}from"./wx-addb0809.js";import{u as W}from"./vue-router.esm-bundler-0ff22247.js";import{O as z}from"./orderClient-feb49149.js";import{ae as L,f as j,r as i,o as q,$ as G,G as _,h as p,j as m,k as e,C as l,v as C,u as E,A as n,B as r,F as H,V as J,n as b,z as A,ag as Q,ah as X,g as K}from"./plugin-vue_export-helper-3a3407bb.js";import{aD as B,aQ as Y}from"./webClient-e9003e98.js";import{l as I}from"./list-3c00e85f.js";import"./_commonjsHelpers-725317a4.js";const c=v=>(Q("data-v-b8c0a666"),v=v(),X(),v),Z={key:0,class:"pannel"},R={class:"pannel-con"},ee={class:"tip-div"},se=["label"],te=["onClick"],oe=["src"],ae={class:"con"},ue={class:"title"},ne={class:"price"},le={class:"pay-con"},ie=c(()=>e("p",null,"支付方式",-1)),ce={class:"flex-algin"},de=c(()=>e("img",{src:M},null,-1)),re=c(()=>e("div",{class:"pay-tag"},"支付宝",-1)),_e=[de,re],pe=c(()=>e("img",{src:U},null,-1)),me=c(()=>e("div",{class:"pay-tag"},"微信",-1)),ve=[pe,me],he={class:"tip"},Fe={class:"flex-algin"},ge={class:"price"},ye={key:0},fe=c(()=>e("br",null,null,-1)),Ce={class:"btn-div"},Ee={class:"wxcode"},Ae=c(()=>e("div",{class:"tip"},"打开手机微信[扫一扫]",-1)),Be={class:"price"},De={class:"code-img"},ke=["src"],be={key:0,class:"success-tip"},Ie=j({__name:"confirmOrder",setup(v){let F=new z;const{proxy:w}=K(),g=i(),D=i(""),y=i(!1),d=i("Alipay"),x=W(),f=i(!1),h=i(),o=i({});q(()=>{h.value=x.query.orderId,O()}),G(()=>{clearInterval(g.value)});const O=()=>{F.getOrderDetilsById(h.value).then(s=>{o.value=s.data})},$=()=>{f.value=!0,F.orderMyOrder(h.value,d.value).then(s=>{if(s.code==0)if(d.value=="Alipay"){const t=document.createElement("div");t.innerHTML=s.data,document.body.appendChild(t),document.forms[0].submit()}else D.value=JSON.parse(s.data).codeUrlImg,y.value=!0,g.value=setInterval(()=>{F.getOrderDetilsById(h.value).then(t=>{t.code==0?(o.value=t.data,o.value.finishStatusCode=="1"&&(clearInterval(g.value),setTimeout(()=>{window.location.href="/mine/orderManage"},1e3))):B({title:"提示",message:t.msg,type:"warning"})})},2e3);else s.code==600?(B({title:"提示",message:"支付成功",type:"success"}),w.goPage("/mine")):B({title:"提示",message:s.msg,type:"error"});f.value=!1})},N=(s,t)=>{let a="";switch(t){case 0:a=`/coachcourse/details?id=${s}`;break;case 1:a=`/coachcourse/videoCourse?courseId=${s}`;break;case 2:a=`/coachcourse/liveCourse?courseId=${s}`;break;case 3:a=`/questionBank/packHome?id=${s}`;break;case 4:a=`/database/detail?id=${s}`;break;case 6:a=`/opencourse/details?id=${s}`;break}window.open(a,"_blank")};return(s,t)=>{const a=_("el-step"),V=_("el-steps"),k=_("el-svg-icon"),S=_("el-button"),P=_("el-dialog");return o.value?(p(),m("div",Z,[e("div",R,[l(V,{active:2,"align-center":""},{default:C(()=>[l(a,{title:"选择商品",icon:E(Y)},null,8,["icon"]),l(a,{title:"确认订单信息",icon:E(I)},null,8,["icon"]),l(a,{title:"支付订单",icon:E(I)},null,8,["icon"])]),_:1}),e("div",ee,[n(" 订单号 "),e("span",null,r(o.value.orderNum),1)]),(p(!0),m(H,null,J(o.value.itemsVosList,(u,T)=>(p(),m("div",{class:"list",key:T,label:u},[e("div",{class:"goods-con pointer",onClick:we=>N(u.commodityId,Number(u.commodityTypeCode))},[e("img",{src:u.imageUrl,alt:""},null,8,oe),e("div",ae,[e("div",ue,[n(r(u.commodityName)+" ",1),e("div",ne,"￥ "+r(u.currentPrice),1)])])],8,te)],8,se))),128)),e("div",le,[ie,e("div",ce,[e("div",{class:b(["pay-cat pointer mr30",{"pay-on":d.value=="Alipay"}]),onClick:t[0]||(t[0]=u=>d.value="Alipay")},_e,2),e("div",{class:b(["pay-cat pointer",{"pay-on":d.value=="WeChat"}]),onClick:t[1]||(t[1]=u=>d.value="WeChat")},ve,2)]),e("div",he,[e("div",Fe,[l(k,{name:"Warning",class:"warning"}),n(" 请在2小时以内支付完成，如未完成此订单将自动关闭。需重新购买！ ")]),e("div",ge,[o.value.discountAmountPrice?(p(),m("div",ye,[n("优惠券："),e("span",null,"-￥"+r(o.value.discountAmountPrice),1)])):A("",!0),fe,e("div",null,[n("应付金额："),e("span",null,"￥"+r(o.value.currentPrice),1)])])])]),e("div",Ce,[l(S,{type:"primary",loading:f.value,onClick:$},{default:C(()=>[n("立即支付")]),_:1},8,["loading"])])]),l(P,{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=u=>y.value=u)},{default:C(()=>[e("div",Ee,[Ae,e("div",Be,[n("支付 "),e("span",null,r(o.value.currentPrice),1),n(" 元")]),e("div",De,[e("img",{src:D.value,alt:""},null,8,ke)]),o.value.finishStatusCode==1?(p(),m("div",be,[l(k,{name:"SuccessFilled",color:"#06C05F",size:40,class:"mr10"}),n(" 支付成功 ")])):A("",!0)])]),_:1},8,["modelValue"])])):A("",!0)}}}),Te=L(Ie,[["__scopeId","data-v-b8c0a666"]]);export{Te as default};
