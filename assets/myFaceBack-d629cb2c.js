import{aG as le,aD as S}from"./webClient-2e88593a.js";import{a as ae,u as oe}from"./vue-router.esm-bundler-926c5a09.js";import{U as ue}from"./userClient-1707b307.js";import{P as ne}from"./publicClient-90b64d32.js";import{_ as ce}from"./plugin-vue_export-helper-c27b6911.js";import{f as ie,r as o,o as de,G as n,h as a,j as u,k as e,n as k,A as r,C as i,v as g,F as b,V as C,t as B,B as d,z as w,af as re,ag as ve}from"./runtime-core.esm-bundler-201072b8.js";import"./commonjsHelpers-725317a4.js";const v=h=>(re("data-v-56714847"),h=h(),ve(),h),_e={class:"nav-con"},pe={key:0,class:"block"},me={class:"item"},ye=v(()=>e("div",{class:"text"},[r("请选择问题类型"),e("span",{class:"label"},"（必填）")],-1)),fe={class:"input"},he={class:"item"},Fe=v(()=>e("div",{class:"text"},[r("反馈信息"),e("span",{class:"label"},"（必填）")],-1)),ke={class:"textarea"},ge={class:"item"},be=v(()=>e("div",{class:"text"},"反馈图片",-1)),Ce={class:"textarea"},Be={class:"num"},we={class:"primary"},Ee=["src"],Ve={key:1,class:"my-list"},De={key:0},xe=["onClick"],Se=v(()=>e("div",{class:"tag-row1"},null,-1)),Ae=v(()=>e("div",{class:"tag-row2"},null,-1)),Le={class:"item-con"},Ue={class:"content"},Te={class:"item-title"},Re={key:0,class:"content-img"},Oe={class:"cat"},ze={class:"time"},Ne={key:0,class:"reply-content"},Ie=v(()=>e("div",{class:"row"},"回复内容",-1)),$e={class:"row row-info"},Pe={class:"row"},je={class:"row-info"},qe=ie({__name:"myFaceBack",setup(h){let $=new ne,A=new ue;const L=o(),U=o({}),_=o(!1),P=ae(),T=oe(),c=o(1),R=o(""),E=o(!1),p=o([]),m=o(""),j=o(""),y=o(""),V=o([]),D=o({}),O=o([]),q=o("http://60.216.20.210:8000/gateway/outside/uploadOss/uploadFiles");de(async()=>{U.value=await{Authorization:le()},c.value=T.query.rType?Number(T.query.rType):1,$.getDataList("feedbackType").then(s=>{O.value=s.data}),N()});const z=s=>{D.value={},c.value=s,P.push(`/mine/myFaceBack?rType=${s}`)},N=async()=>{await A.getFeedbackListByUser().then(s=>{V.value=s.data})},G=s=>{D.value=s},M=async()=>{if(_.value=!0,!m.value){S({title:"提示",message:"请选择问题类型",type:"warning"}),_.value=!1;return}if(!y.value){S({title:"提示",message:"请填写反馈信息",type:"warning"}),_.value=!1;return}let s=[],l;if(p.value.length>0)for(l of p.value)s.push(l.response[0].pathOSSStr);A.addFeedback(m.value,y.value,2,s.length>0?s:void 0).then(f=>{f.code==0&&(L.value.clearFiles(),j.value="",y.value="",m.value="",p.value=[],N()),_.value=!1})},H=s=>{R.value=s.response[0].pathOSSStr,E.value=!0},J=s=>{s.size/1024/1024<3||S.warning("文件大小超过 3MB")},K=async(s,l,f)=>{p.value=f};return(s,l)=>{const f=n("el-option"),Q=n("el-select"),W=n("el-input"),X=n("el-svg-icon"),Y=n("el-upload"),Z=n("el-dialog"),ee=n("el-button"),I=n("el-image"),te=n("el-empty");return a(),u("div",null,[e("div",_e,[e("div",{class:k(["nav-con-item",c.value==1?"ontext":""]),onClick:l[0]||(l[0]=t=>z(1))},[r(" 我要反馈 "),e("div",{class:k(c.value==1?"onview":"")},null,2)],2),e("div",{class:k(["nav-con-item",c.value==2?"ontext":""]),onClick:l[1]||(l[1]=t=>z(2))},[r(" 我的反馈 "),e("div",{class:k(c.value==2?"onview":"")},null,2)],2)]),c.value==1?(a(),u("div",pe,[e("div",me,[ye,e("div",fe,[i(Q,{modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=t=>m.value=t),clearable:"",placeholder:"请选择"},{default:g(()=>[(a(!0),u(b,null,C(O.value,t=>(a(),B(f,{key:t.key,label:t.value,value:t.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),e("div",he,[Fe,e("div",ke,[i(W,{modelValue:y.value,"onUpdate:modelValue":l[3]||(l[3]=t=>y.value=t),type:"textarea","show-word-limit":"",clearable:"",maxlength:"200",placeholder:"请输入您的问题，以便我们为您提供帮助~"},null,8,["modelValue"])])]),e("div",ge,[be,e("div",Ce,[i(Y,{class:"el-upload-box",ref_key:"upload",ref:L,name:"file",multiple:"",action:q.value,headers:U.value,limit:3,"list-type":"picture-card",accept:".jpg,.png","before-upload":J,"on-preview":H,"on-success":K},{default:g(()=>[i(X,{name:"Plus"})]),_:1},8,["action","headers"]),e("span",Be,[e("span",we,d(p.value.length),1),r("/3")]),i(Z,{modelValue:E.value,"onUpdate:modelValue":l[4]||(l[4]=t=>E.value=t),"append-to-body":""},{default:g(()=>[e("img",{src:R.value,alt:"",style:{width:"100%",height:"auto"}},null,8,Ee)]),_:1},8,["modelValue"])])]),i(ee,{class:"item-btn",loading:_.value,onClick:l[5]||(l[5]=t=>M())},{default:g(()=>[r("提交反馈")]),_:1},8,["loading"])])):w("",!0),c.value==2&&!D.value.feedbackUser?(a(),u("div",Ve,[V.value.length>0?(a(),u("div",De,[(a(!0),u(b,null,C(V.value,(t,se)=>(a(),u("div",{class:"my-list-item",key:se,onClick:F=>G(t)},[Se,Ae,e("div",Le,[e("div",Ue,[e("div",Te,d(t.content),1),t.pictureList.length>0?(a(),u("div",Re,[(a(!0),u(b,null,C(t.pictureList,(F,x)=>(a(),B(I,{src:F,alt:"",key:x,"preview-src-list":t.pictureList},null,8,["src","preview-src-list"]))),128))])):w("",!0),e("div",Oe,[e("div",null,d(t.type),1),e("div",ze,"提交时间："+d(t.createTime),1)])]),t.feedbackReplyVO?(a(),u("div",Ne,[Ie,e("div",$e,d(t.feedbackReplyVO.content),1),e("div",Pe,[(a(!0),u(b,null,C(t.feedbackReplyVO.pictureList,(F,x)=>(a(),B(I,{src:F,alt:"",key:x,"preview-src-list":t.feedbackReplyVO.pictureList},null,8,["src","preview-src-list"]))),128))]),e("div",je,"回复时间："+d(t.feedbackReplyVO.createTime),1)])):w("",!0)])],8,xe))),128))])):(a(),B(te,{key:1,description:"暂无数据~"}))])):w("",!0)])}}}),Xe=ce(qe,[["__scopeId","data-v-56714847"]]);export{Xe as default};
