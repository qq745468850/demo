import{aE as he,aG as me,N as z,aD as oe,aC as ge}from"./webClient-2e88593a.js";import{_ as ye}from"./user-b1b56a44.js";import{E as fe}from"./evaluatView-3e999aa8.js";import{C as ke}from"./coachClient-6606bd3e.js";import{_ as we}from"./plugin-vue_export-helper-c27b6911.js";import{f as Ce,r as u,o as Fe,G as B,h as o,j as i,k as e,n as b,x as N,m as Be,F as g,V as y,B as n,t as E,C as f,v as ie,A as q,z as r,af as be,ag as Ee,g as Ie}from"./runtime-core.esm-bundler-201072b8.js";const Se=I=>(be("data-v-6b74d435"),I=I(),Ee(),I),Ve={class:"content-con"},xe={class:"tab"},Ae={class:"tab-block"},Le={class:"points"},qe={key:0,class:"video-list"},De={class:"card-carousel-wrapper"},Te=["disabled"],Ue={class:"card-carousel"},$e={class:"card-carousel--overflow-container"},ze=["onClick"],Ne=["title"],Pe={class:"block"},Qe={class:"img"},Re=["src"],Me={class:"item-time"},Oe=["disabled"],Ke={class:"question"},je={class:"question-tab"},He=Se(()=>e("div",{class:"question-tip"},"答疑提问",-1)),Ge={class:"input-box"},Xe={class:"uploadImg"},Je={class:"upload-tip"},We={class:"primary"},Ye={key:0,class:"question-list"},Ze={class:"row"},es=["src"],ss={class:"head"},ts={class:"name"},os={class:"time"},is={class:"con"},as={key:0,class:"question-img"},ls={key:1,class:"showInput"},us={class:"uploadImg"},ns={class:"upload-tip"},cs={class:"primary"},ds=["onClick"],rs={class:"replyCon"},vs={class:"replyUser"},ps={key:0,class:"head-img",src:ye,alt:""},_s=["src"],hs={class:"head"},ms={class:"name"},gs={key:0,class:"best"},ys={key:1,class:"me"},fs={key:2,class:"me"},ks={class:"time"},ws={class:"con"},Cs={key:0,class:"question-img"},Fs={class:"row"},Bs=["src"],bs={class:"head"},Es={class:"name"},Is={key:0,class:"best"},Ss={class:"time"},Vs={class:"con"},xs={key:0,class:"question-img"},As={key:1,class:"replyCon"},Ls={class:"replyHead"},qs={class:"replyUser"},Ds=["src"],Ts={class:"head"},Us={class:"name"},$s={key:0,class:"me"},zs={key:1,class:"me"},Ns={class:"time"},Ps={class:"con"},Qs={key:0,class:"question-img"},Rs={key:0,class:"teachingScore mt17"},Ms=Ce({__name:"KnowledgeView",props:{type:{type:Number,default:1},id:{type:String,default:""},courseId:{type:String,default:""},teacherId:{type:String,default:""}},emits:["clickSeekTime"],setup(I,{emit:ae}){const c=I;let k=new ke;const{proxy:P}=Ie(),j=u(0),H=u(0),Q=u({}),G=u(0),w=u([]),C=u([]),_=u(1),R=u(),M=u(),v=u([]),p=u(1),S=u(""),V=u(""),D=u(0),T=u(10),U=u(1),x=u(0),le=u(7),O=u(163),A=u([]),K=u({}),X=u("http://60.216.20.210:8000/gateway/outside/uploadOss/uploadFiles");Fe(async()=>{await ue(),await L(1),K.value=await he(),Q.value=await{Authorization:me()},A.value.length>0&&(M.value=x.value===0,R.value=x.value<=O.value*-1*(A.value.length-le.value))});const ue=async()=>{let a=await k.getVideoSegmentList(c.id);A.value=a.data},ne=async(a,t)=>{if(V.value==""){oe({title:"提示",message:"请输入回答内容",type:"warning"});return}let d=[];if(C.value.length>0){let m;for(m of C.value)d.push(m.response[0].pathOSSStr)}await k.replyQuestionsPC(0,a,V.value,d.length>0?d:void 0).then(m=>{m.code==0&&(V.value="",C.value=[],v.value[t].showReplay=!v.value[t].showReplay,L(p.value),P.$forceUpdate())})},ce=async()=>{if(S.value==""){oe({title:"提示",message:"请输入内容",type:"warning"});return}let a=[],t;if(w.value.length>0)for(t of w.value)a.push(t.response[0].pathOSSStr);await k.addAnswerQuestion(0,0,S.value,c.type,c.courseId,c.id,c.teacherId,a.length>0?a:void 0).then(d=>{d.code==0&&(P.$refs.elUpload.clearFiles(),S.value="",w.value=[],L(p.value),P.$forceUpdate())})},L=async a=>{a==1?await k.getQuestionListByCourse(U.value,T.value,c.courseId,c.id,0).then(t=>{v.value=t.data.rows,D.value=t.data.total}):a==2?await k.getReplyCourseDataList(U.value,T.value,c.courseId,c.id).then(t=>{v.value=t.data.rows,D.value=t.data.total}):a==3&&await k.getQuestionListByCourse(U.value,T.value,c.courseId,c.id,1).then(t=>{v.value=t.data.rows,D.value=t.data.total});for(let t of v.value)t.showReplay=!1},J=a=>{if(!(a.size/1024/1024<2)){ge.warning("文件大小超过 2MB");return}},de=(a,t,d)=>{w.value=d},re=(a,t,d)=>{C.value=d},ve=a=>{U.value=a,L(p.value)},pe=(a,t)=>{G.value=a,ae("clickSeekTime",t)},W=a=>{a===1&&!R.value?x.value-=O.value:a===-1&&!M.value&&(x.value+=O.value)},Y=async a=>{p.value=a,v.value=[],L(a)};return(a,t)=>{const d=B("el-empty"),m=B("el-input"),Z=B("el-svg-icon"),ee=B("el-upload"),$=B("el-image"),_e=B("el-pagination");return o(),i("div",null,[e("div",Ve,[e("div",xe,[e("div",Ae,[e("div",{class:b(_.value==1?"tab-item on":"tab-item"),onClick:t[0]||(t[0]=s=>_.value=1)}," 知识点 ",2),e("div",{class:b(_.value==2?"tab-item on":"tab-item"),onClick:t[1]||(t[1]=s=>_.value=2)}," 课程答疑 ",2),e("div",{class:b(_.value==3?"tab-item on":"tab-item"),onClick:t[2]||(t[2]=s=>_.value=3)}," 授课评分 ",2)])]),N(e("div",Le,[A.value.length>0?(o(),i("div",qe,[e("div",De,[e("div",{class:"video-list-left",onClick:t[3]||(t[3]=s=>W(-1)),disabled:M.value},null,8,Te),e("div",Ue,[e("div",$e,[e("div",{class:"card-carousel-cards",style:Be({transform:"translateX("+x.value+"px)"})},[(o(!0),i(g,null,y(A.value,(s,F)=>(o(),i("div",{class:"card-carousel--card",key:F,onClick:l=>pe(F,s.pointSec)},[e("div",{class:b(G.value==F?"item on":"item")},[e("div",{class:"item-name ellipsis",title:s.pointName},n(s.pointName),9,Ne),e("div",Pe,[e("div",Qe,[e("img",{src:s.screenShotLink},null,8,Re)]),e("div",Me,n(s.pointTime),1)])],2)],8,ze))),128))],4)])]),e("div",{class:"video-list-right",onClick:t[4]||(t[4]=s=>W(1)),disabled:R.value},null,8,Oe)])])):(o(),E(d,{key:1,description:"暂无数据~"}))],512),[[z,_.value==1]]),N(e("div",Ke,[e("div",je,[e("div",{class:b(p.value==1?"question-tab-item on":"question-tab-item"),onClick:t[5]||(t[5]=s=>Y(1))}," 全部答疑 ",2),e("div",{class:b(p.value==3?"question-tab-item on":"question-tab-item"),onClick:t[6]||(t[6]=s=>Y(3))}," 我的提问 ",2)]),He,e("div",Ge,[f(m,{type:"textarea",placeholder:"请输入内容",modelValue:S.value,"onUpdate:modelValue":t[7]||(t[7]=s=>S.value=s),rows:4,maxlength:"200","show-word-limit":""},null,8,["modelValue"]),e("div",Xe,[f(ee,{class:"el-upload",ref:"elUpload",multiple:"",action:X.value,headers:Q.value,name:"file",limit:3,"list-type":"picture-card",accept:".jpg,.png","before-upload":J,"on-success":de,disabled:w.value.length==3},{default:ie(()=>[f(Z,{name:"Plus"})]),_:1},8,["action","headers","disabled"]),e("div",Je,[e("span",We,n(w.value.length),1),q("/3     点击上传图片（最多可上传3张，每张小于2M） ")]),e("div",{class:"sub-btn pointer",onClick:t[8]||(t[8]=s=>ce())}," 确认提交 ")])]),v.value.length>0?(o(),i("div",Ye,[(o(!0),i(g,null,y(v.value,(s,F)=>(o(),i("div",{class:"question-item",key:F},[N(e("div",Ze,[e("img",{class:"head-img",src:s.headPortrait,alt:""},null,8,es),e("div",ss,[e("div",ts,n(s.nickName),1),e("div",os,n(s.startTime),1),e("div",is,n(s.content),1),s.pictureList?(o(),i("div",as,[(o(!0),i(g,null,y(s.pictureList,(l,h)=>(o(),E($,{src:l,alt:"",key:h,"preview-src-list":s.pictureList,"initial-index":j.value,onClick:se=>j.value=h},null,8,["src","preview-src-list","initial-index","onClick"]))),128))])):r("",!0),p.value!=2&&s.showReplay?(o(),i("div",ls,[f(m,{type:"textarea",placeholder:"请输入内容",rows:4,maxlength:"200","show-word-limit":"",modelValue:V.value,"onUpdate:modelValue":t[9]||(t[9]=l=>V.value=l)},null,8,["modelValue"]),e("div",us,[f(ee,{class:"el-upload",ref_for:!0,ref:"elUpload",multiple:"",action:X.value,headers:Q.value,name:"file",limit:3,"list-type":"picture-card",accept:".jpg,.png","before-upload":J,"on-success":re,disabled:C.value.length==3},{default:ie(()=>[f(Z,{name:"Plus"})]),_:1},8,["action","headers","disabled"]),e("div",ns,[e("span",cs,n(C.value.length),1),q("/3     点击上传图片（最多可上传3张，每张小于2M） ")]),e("div",{class:"sub-btn pointer m-t-10",style:{right:"0"},onClick:l=>ne(s.questionId,F)}," 提交回答 ",8,ds)])])):r("",!0),e("div",rs,[(o(!0),i(g,null,y(s.answerBasicVos,(l,h)=>(o(),i("div",{class:"replyHead",key:h},[e("div",vs,[l.userType==1||l.userType==2?(o(),i("img",ps)):(o(),i("img",{key:1,class:"head-img",src:l.headPortrait,alt:""},null,8,_s)),e("div",hs,[e("div",ms,[q(n(l.username)+" ",1),l.isBest==1?(o(),i("div",gs,"最佳回答")):r("",!0),K.value.userId==l.answerUserId?(o(),i("div",ys," 我 ")):(o(),i("div",fs,n(l.userType==0?"同学":l.userType==1?"教务老师":"教学老师"),1))]),e("div",ks,n(l.createTime),1),e("div",ws,n(l.content),1)])]),l.pictureList?(o(),i("div",Cs,[(o(!0),i(g,null,y(l.pictureList,(se,te)=>(o(),E($,{src:se,alt:"",key:te,"preview-src-list":l.pictureList,"initial-index":H.value,onClick:Os=>H.value=te},null,8,["src","preview-src-list","initial-index","onClick"]))),128))])):r("",!0)]))),128))])])],512),[[z,p.value==1||p.value==3]]),N(e("div",Fs,[e("img",{class:"head-img",src:s.headPortrait,alt:""},null,8,Bs),e("div",bs,[e("div",Es,[q(n(s.username),1),s.isBest==1?(o(),i("div",Is,"最佳回答")):r("",!0)]),e("div",Ss,n(s.createTime),1),e("div",Vs,n(s.content),1),s.pictureList?(o(),i("div",xs,[(o(!0),i(g,null,y(s.pictureList,(l,h)=>(o(),E($,{src:l,alt:"",key:h,"preview-src-list":s.pictureList},null,8,["src","preview-src-list"]))),128))])):r("",!0),s.courseVo?(o(),i("div",As,[e("div",Ls,[e("div",qs,[e("img",{class:"head-img",src:s.courseVo.headPortrait,alt:""},null,8,Ds),e("div",Ts,[e("div",Us,[q(n(s.courseVo.nickName)+" ",1),K.value.userId==s.courseVo.askUserId?(o(),i("div",$s,"我")):(o(),i("div",zs,"同学"))]),e("div",Ns,n(s.courseVo.createTime),1),e("div",Ps,n(s.courseVo.content),1)])]),s.courseVo.pictureList?(o(),i("div",Qs,[(o(!0),i(g,null,y(s.courseVo.pictureList,(l,h)=>(o(),E($,{src:l,alt:"",key:h,"preview-src-list":s.courseVo.pictureList},null,8,["src","preview-src-list"]))),128))])):r("",!0)])])):r("",!0)])],512),[[z,p.value==2]])]))),128)),v.value.length>0?(o(),E(_e,{key:0,background:"",layout:"prev, pager, next",total:D.value,"page-size":T.value,onCurrentChange:ve},null,8,["total","page-size"])):r("",!0)])):r("",!0)],512),[[z,_.value==2]]),_.value==3?(o(),i("div",Rs,[f(fe,{type:c.type==1?11:12,typeId:c.id},null,8,["type","typeId"])])):r("",!0)])])}}}),Ws=we(Ms,[["__scopeId","data-v-6b74d435"]]);export{Ws as K};
